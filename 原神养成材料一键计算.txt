原神养成材料一键计算v1.0（支持钟离，公子等）

===1 前言===
不知道大家xp练卡的时候，有没有遇到过同时养多个角色/武器/圣遗物的时候，材料查询再汇总非常麻烦，同时还要规划周几打什么，再加上某些材料可以合成其实可能不需要打这样。。所以用vba写了个一键计算的脚本，一键包邮解君愁[s:ac:茶]
目前能查到的资料多多少少都有不准确的地方，所以我在excel里把数据来源都标注出来了。如果发现数据有不对的地方可以说一下，我会找时间更正。
文件放在帖子最后，我自己试用了一下暂时没发现问题，[del]没发现bug就是没有bug。[/del]代码我放在gitee上了，泥潭有懂的老哥可以帮忙捉捉虫。[s:ac:上]
gitee仓库地址：[url]https://gitee.com/hmfsh61/genshin-impact[/url]
[quote]
更新日志
[list]
[*]2020年10月23日 03:34:39 [b]v1.0[/b]
[/quote][/list]

===2 特性===
[list]
[*]所有计算都是[b]一键完成[/b]，你只需要填你有什么材料，你想养什么。
[*]支持从中间等级开始计算。如刻晴60-80级，西风猎弓60-70级。
[*]理论上支持任意角色/武器/圣遗物的养成组合。
[*]通过输入你背包中已有材料的数量，可以自动计算差值并判断缺口情况。
[*]对可合成类材料，如史莱姆凝液/清/原浆，可以自动根据你的材料富余情况计算可合成数量。
[*]在计算结果后面会给出具体的需求来源和数量，[del]用于需求远远超出肝度时把低xp卡vote掉。[/del]
[*]由于目前原神不同角色的养成材料数量一样，只是材料类型不同，因此支持计算未实装角色，如钟离，公子等。[del]实际请以正式数据为准，此处应有文案修复。[/del]
[*]多次计算时无需删除之前的计算结果，只需修改你的养成目标即可。（会自动清除）
[*]补充说明：
[collapse=为什么是理论上？]
理论上拉太多要养的东西的话，可能导致摩拉等数据太大，数据溢出。。调试的时候我代入了目前已知的全角色，1-90级拉满，天赋1-10拉满，暂时没发现问题[s:ac:计划通]
[/collapse]
[collapse=合成计算逻辑]
合成策略：计算材料需求情况，得到缺口/富余数据，从低级到高级依次查看缺口是否可以通过富余的低级材料合成，更新缺口/富余数据
简而言之：[b]按照计算得出的可合成数量无脑合即可[/b]，不会出现合成了之后让某个本来需要的材料不够的情况。
[/collapse]
[/list]

===3 使用===
打开excel文件后如图所示：
（这是图。png）
使用方法：
[quote][list]
[*][b]必须[/b]点击黄色提示中的按钮「启用宏」。（因为excel默认是关闭的，不启用就无法使用代码自动计算）
[*]仿照给出的例子填写你想养的角色/武器/圣遗物。其中圣遗物名称可以随意写，这个数据仅用于需求来源提示，但角色和武器的名称[b]必须[/b]正确填写。（如果不确定你填的名称对不对，可以直接从后面的表中复制）
[*]在「背包-养成道具」和「背包-材料」两个表格中，填写你已有的材料数量。如果嫌麻烦的话，可以直接全拉成0。（但没必要= =因为两个背包页中物品的顺序都是和游戏内一致的（除了龙狼材料，因为我有的不全，所以我也不知道这几个的顺序是啥），照着抄一下也挺快的）
[*]最后切回首页，点击材料计算按钮即可。
[/quote][/list]
结果如下：
（这是图。png）

===4 说明===
一些可能会遇到问题的地方，如果有疑问可以先看看这里~
[list]
[*]人物和武器等级[b]只能[/b]填写1,20,40...90等这几个阶段等级，因为可以查到的资料只有这几个等级的。如果大家有具体到每一级的资料的话，可以说一下~
[*]人物和武器突破材料计算统一为[b]未突破[/b]状态，如刻晴60级→80级，会计算从60级未突破到80级未突破所需要的材料。
[*]不小心填错了，使当前等级>目标等级，如天赋100级→3级时，会自动忽略，无需担心。
[*]角色/武器/圣遗物计算会从第2行开始，直到[b]各自[/b]的第一个空行为止。所以如果你要养的东西很多的话，可以自行在下面继续添加。
[*]如果材料计算那个按钮挡住了你的表格，对按钮点右键之后就可以选中并随意移动了。
[*]角色经验/武器经验/圣遗物狗粮等材料会有两个缺口数字，一个是具体缺少的经验值，另一个是换算成[b]对应所在行[/b]的材料需要的数量。如经验缺口为677100和34，代表还需要677100经验，等价于34个大英雄的经验。
[*]想知道周几需要打什么的话，可以用excel的筛选功能对「背包-养成道具」中的[b]周期性[/b]这个字段进行筛选。下次计算时会自动取消你做的筛选，无需手动取消。
[*]可合成材料的缺口数量，如8（可合成4），代表你需要8个，其中4个可以直接通过合成获得（合成路径不限），即一共只需再锄4个。
[*]目前没有计算合成本身消耗的摩拉数量，[del]锄大地党的末路。[/del]
[*]计算未实装角色的天赋需求，如钟离天赋一1级→10级，会自动忽略龙狼材料，因为没找到资料是啥。
[*]目前三星武器的资料只收录了半莫，如果你需要计算其它三星武器，可以自行在「武器」表中添加对应的数据。
[*]后续版本如果添加了新角色，新武器，新等级等内容时，你可以自行在对应的页签中添加相应的资料，[b]不出意外[/b]的话，这个计算器是仍然可以正确计算的。[del]你尽管折腾，玩坏了算我输[/del][s:ac:哭笑]
[/list]
[quote][list]
[*]如果遇到了报错，可以在[b]保存[/b]你的excel文件后，发送到我的邮箱[u]hmfsh61@qq.com[/u]，这样我能很快定位到问题，并且很方便地给出回复。
[*]如果你在使用中遇到了问题，或者有啥想加的功能可以在帖子里留言，有时间我会加一下，[del]毕竟更新日志待施工。[/del]
[/quote][/list]

===5 后记===
我的box挺浅的，拉到满的只有温迪，很多时候本打不过只能联机。泥潭里每天都有吐槽联机环境的，虽然也有遇到一开口就让别人切这切那的懂王，但个人感觉联机遇到的还是人狠话不多的兄弟居多。[del]路人：我进本了，怪我秒了，有什么好说的呢？[/del]在此谢谢路人联机带我躺的hxd奥[s:ac:赞同]
想有个卢锅巴主c但抽不起，米抠游的尿性也不说啥了，希望能早日玩上吧。刀刀烈火才是男人的浪漫！[s:a2:jojo立3]

不多说了，最后希望大家玩得开心~
（这是附件。rar）